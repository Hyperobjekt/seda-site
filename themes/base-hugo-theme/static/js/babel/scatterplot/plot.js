"use strict";function _extends(){return _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},_extends.apply(this,arguments)}/* use strict */(function(a){var b={scatterplot:null,wrappers:[],top:null,height:null,bottom:null,isTransitional:!1,activeState:"state1",// searchItemIDs: [],
searchEl:null,searchProps:{// Props passed in to init the search input(s)
algoliaId:"QPJ12WSVR4",algoliaKey:"bae9e4604dbd263cc47c48bfb30dd5dc",onSuggestionSelected:function onSuggestionSelected(a){searchItemIDs[0]=a.id,scatterplot.loadState(b.activeState);!!dataLayer&&3<=dataLayer.length?dataLayer.push({event:"districtHighlighted",highlightedDistrict:a.name}):console.log("dataLayer not available. Skipping analytics reporting for highlighted item select.")},onSelectedClear:function onSelectedClear(){// console.log(e);
// Clear search item array
// Reload state
searchItemIDs=[],scatterplot.loadState(b.activeState)},indices:["districts"],inputProps:{placeholder:"Highlight a district...","aria-label":"Enter a district name to search"}},renderSearch:function renderSearch(){// $elements = $('.search-component');
// $elements.each(function(el) {
//   (plot.searchEl).push(new plot.searchInit(plot.searchProps, el));
// });
var a=document.getElementById("searchComponent");b.searchEl=new b.searchInit(b.searchProps,a)},searchInit:function searchInit(a,b){var c=this,d=_extends(a,{ref:function ref(a){c.component=a}});// add reference to the component to props
this.render=function(a){ReactDOM.render(React.createElement(SedaSearch,a,null),b)},this.render(d)},update:function update(){// console.log('update');
var c=a.grep(b.wrappers,function(c){b.top=b.scatterplot.offset().top+120;// + 462;
var d=a(c).offset().top,e=a(c).outerHeight();// $(el).offset().top - $(window).scrollTop();
// var wrapperHeight = $(el).height();
// If plot top or bottom are within
// add to activeWrappers.
// console.log('plot.top = ' + plot.top);
// console.log('offset().top = ' + $(el).offset().top);
// console.log('scrolltop = ' + $(window).scrollTop());
// console.log('wrapperTop = ' + wrapperTop);
// console.log('wrapperBottom = ' + wrapperBottom);
if(b.top>=d&&b.top<=+d+ +e)// console.log('It\'s within a wrapper.');
return a(c)});// console.log(activeWrappers);
if(1==c.length){b.scatterplot.removeClass("transitional"),b.isTransitional=!1;// Set state to the first one.
// console.log(activeWrappers[0]);
var d=a(c[0]).attr("data-plot-state"),e=!!a(c[0]).attr("data-plot-notmerge")&&a(c[0]).attr("data-plot-notmerge");d!==b.activeState&&(console.log("loading new state "+d),e?scatterplot.loadState(d,{notMerge:!0}):scatterplot.loadState(d),b.activeState=d)}else(0===c.length||1<=c.length)&&(b.scatterplot.addClass("transitional"),b.isTransitional=!0)},getCoords:function getCoords(){b.top=b.scatterplot.offset().top,b.height=b.scatterplot.find("> div").height(),b.bottom=+b.top+ +b.height}};// Get top and bottom y coords of the scatterplot
// Reset them if the screen is resized
// Only trigger scroll ever 50ms so less resources
b.scatterplot=a("#scatterplot"),b.wrappers=a(".state-desc-wrapper"),b.getCoords(),a(window).resize(function(){// plot.top = (plot.scatterplot).offset().top;
// plot.height = (plot.scatterplot).find('> div').height();
// plot.bottom = Number(plot.top) + Number(plot.height);
b.getCoords()}),scatterplot.on("ready",function(){var c=!1;a(window).scroll(function(){c=!0}),setInterval(function(){c&&(b.update(),c=!1)},50),1<=a(".search-component").length&&b.renderSearch()}),scatterplot.loadState("state1")})(jQuery);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zY2F0dGVycGxvdC9wbG90LmpzIl0sIm5hbWVzIjpbIiQiLCJwbG90Iiwic2NhdHRlcnBsb3QiLCJ3cmFwcGVycyIsInRvcCIsImhlaWdodCIsImJvdHRvbSIsImlzVHJhbnNpdGlvbmFsIiwiYWN0aXZlU3RhdGUiLCJzZWFyY2hFbCIsInNlYXJjaFByb3BzIiwiYWxnb2xpYUlkIiwiYWxnb2xpYUtleSIsIm9uU3VnZ2VzdGlvblNlbGVjdGVkIiwiaGl0Iiwic2VhcmNoSXRlbUlEcyIsImxvYWRTdGF0ZSIsImRhdGFMYXllciIsImxlbmd0aCIsInB1c2giLCJjb25zb2xlIiwibG9nIiwib25TZWxlY3RlZENsZWFyIiwiaW5kaWNlcyIsImlucHV0UHJvcHMiLCJwbGFjZWhvbGRlciIsInJlbmRlclNlYXJjaCIsInJvb3RFbCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzZWFyY2hJbml0IiwicHJvcHMiLCJjb250YWluZXIiLCJfc2VsZiIsInJlZlByb3BzIiwicmVmIiwiY29tcG9uZW50IiwicmVuZGVyIiwiUmVhY3RET00iLCJSZWFjdCIsImNyZWF0ZUVsZW1lbnQiLCJTZWRhU2VhcmNoIiwidXBkYXRlIiwiYWN0aXZlV3JhcHBlcnMiLCJncmVwIiwiZWwiLCJvZmZzZXQiLCJ3cmFwcGVyVG9wIiwid3JhcHBlckhlaWdodCIsIm91dGVySGVpZ2h0IiwicmVtb3ZlQ2xhc3MiLCJzdGF0ZSIsImF0dHIiLCJub3RtZXJnZSIsIm5vdE1lcmdlIiwiYWRkQ2xhc3MiLCJnZXRDb29yZHMiLCJmaW5kIiwid2luZG93IiwicmVzaXplIiwib24iLCJ1c2VyU2Nyb2xsZWQiLCJzY3JvbGwiLCJzZXRJbnRlcnZhbCIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IitPQUFBLGdCQUVBLENBQUMsU0FBU0EsQ0FBVCxDQUFZLENBRVQsR0FBTUMsQ0FBQUEsQ0FBSSxDQUFHLENBQ1RDLFdBQVcsQ0FBRSxJQURKLENBRVRDLFFBQVEsQ0FBRSxFQUZELENBR1RDLEdBQUcsQ0FBRSxJQUhJLENBSVRDLE1BQU0sQ0FBRSxJQUpDLENBS1RDLE1BQU0sQ0FBRSxJQUxDLENBTVRDLGNBQWMsR0FOTCxDQU9UQyxXQUFXLENBQUUsUUFQSixDQVFUO0FBQ0FDLFFBQVEsQ0FBRSxJQVRELENBVVRDLFdBQVcsQ0FBRSxDQUFFO0FBQ2JDLFNBQVMsQ0FBRSxZQURBLENBRVhDLFVBQVUsQ0FBRSxrQ0FGRCxDQUdYQyxvQkFBb0IsQ0FBRSw4QkFBU0MsQ0FBVCxDQUFjLENBR2xDQyxhQUFhLENBQUMsQ0FBRCxDQUFiLENBQW1CRCxDQUFHLEdBSFksQ0FLbENaLFdBQVcsQ0FBQ2MsU0FBWixDQUFzQmYsQ0FBSSxDQUFDTyxXQUEzQixDQUxrQyxDQVE5QixDQUFDLENBQUNTLFNBQUYsRUFBb0MsQ0FBcEIsRUFBQUEsU0FBUyxDQUFDQyxNQVJJLENBU2hDRCxTQUFTLENBQUNFLElBQVYsQ0FBZSxDQUNiLE1BQVMscUJBREksQ0FFYixvQkFBdUJMLENBQUcsS0FGYixDQUFmLENBVGdDLENBY2hDTSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxvRkFBWixDQUVILENBbkJVLENBb0JYQyxlQUFlLENBQUUsMEJBQVksQ0FDM0I7QUFDQTtBQUVBO0FBREFQLGFBQWEsQ0FBRyxFQUhXLENBSzNCYixXQUFXLENBQUNjLFNBQVosQ0FBc0JmLENBQUksQ0FBQ08sV0FBM0IsQ0FDRCxDQTFCVSxDQTJCWGUsT0FBTyxDQUFFLENBQUMsV0FBRCxDQTNCRSxDQTRCWEMsVUFBVSxDQUFFLENBQ1ZDLFdBQVcsQ0FBRSx5QkFESCxDQUVWLGFBQWMsaUNBRkosQ0E1QkQsQ0FWSixDQTJDVEMsWUFBWSxDQUFFLHVCQUFXLENBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBSUMsQ0FBQUEsQ0FBTSxDQUFHQyxRQUFRLENBQUNDLGNBQVQsQ0FBd0IsaUJBQXhCLENBQWIsQ0FDQTVCLENBQUksQ0FBQ1EsUUFBTCxDQUFnQixHQUFJUixDQUFBQSxDQUFJLENBQUM2QixVQUFULENBQW9CN0IsQ0FBSSxDQUFDUyxXQUF6QixDQUFzQ2lCLENBQXRDLENBQ2pCLENBbERRLENBbURURyxVQUFVLENBQUUsb0JBQVNDLENBQVQsQ0FBZ0JDLENBQWhCLENBQTJCLElBQ2pDQyxDQUFBQSxDQUFLLENBQUcsSUFEeUIsQ0FJakNDLENBQVEsQ0FBRyxTQUFjSCxDQUFkLENBQXFCLENBQ2xDSSxHQUFHLENBQUUsYUFBU0EsQ0FBVCxDQUFjLENBQUVGLENBQUssQ0FBQ0csU0FBTixDQUFrQkQsQ0FBTSxDQURYLENBQXJCLENBSnNCLENBR3JDO0FBS0EsS0FBS0UsTUFBTCxDQUFjLFNBQVNOLENBQVQsQ0FBZ0IsQ0FDNUJPLFFBQVEsQ0FBQ0QsTUFBVCxDQUNFRSxLQUFLLENBQUNDLGFBQU4sQ0FBb0JDLFVBQXBCLENBQWdDVixDQUFoQyxDQUF1QyxJQUF2QyxDQURGLENBRUVDLENBRkYsQ0FJRCxDQWJvQyxDQWNyQyxLQUFLSyxNQUFMLENBQVlILENBQVosQ0FDRCxDQWxFUSxDQW1FVFEsTUFBTSxDQUFFLGlCQUFXLENBQ2Y7QUFDQSxHQUFJQyxDQUFBQSxDQUFjLENBQUczQyxDQUFDLENBQUM0QyxJQUFGLENBQU8zQyxDQUFJLENBQUNFLFFBQVosQ0FBc0IsU0FBUzBDLENBQVQsQ0FBYSxDQUVwRDVDLENBQUksQ0FBQ0csR0FBTCxDQUFZSCxDQUFJLENBQUNDLFdBQU4sQ0FBbUI0QyxNQUFuQixHQUE0QjFDLEdBQTVCLENBQWtDLEdBRk8sQ0FFRjtBQUZFLEdBR2hEMkMsQ0FBQUEsQ0FBVSxDQUFHL0MsQ0FBQyxDQUFDNkMsQ0FBRCxDQUFELENBQU1DLE1BQU4sR0FBZTFDLEdBSG9CLENBS2hENEMsQ0FBYSxDQUFHaEQsQ0FBQyxDQUFDNkMsQ0FBRCxDQUFELENBQU1JLFdBQU4sRUFMZ0MsQ0FHZjtBQUNyQztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBS2hELENBQUksQ0FBQ0csR0FBTCxFQUFZMkMsQ0FBWixFQUEwQjlDLENBQUksQ0FBQ0csR0FBTCxFQVJYLENBQU8yQyxDQUFQLEdBQTRCQyxDQVFoRCxDQUNJO0FBQ0EsTUFBT2hELENBQUFBLENBQUMsQ0FBQzZDLENBQUQsQ0FFZixDQWxCb0IsQ0FBckIsQ0FtQkE7QUFDQSxHQUE2QixDQUF6QixFQUFBRixDQUFjLENBQUN6QixNQUFuQixDQUFnQyxDQUUzQmpCLENBQUksQ0FBQ0MsV0FBTixDQUFtQmdELFdBQW5CLENBQStCLGNBQS9CLENBRjRCLENBRzVCakQsQ0FBSSxDQUFDTSxjQUFMLEdBSDRCLENBSTVCO0FBQ0E7QUFMNEIsR0FNeEI0QyxDQUFBQSxDQUFLLENBQUduRCxDQUFDLENBQUMyQyxDQUFjLENBQUMsQ0FBRCxDQUFmLENBQUQsQ0FBcUJTLElBQXJCLENBQTBCLGlCQUExQixDQU5nQixDQU94QkMsQ0FBUSxHQUNSckQsQ0FBQyxDQUFDMkMsQ0FBYyxDQUFDLENBQUQsQ0FBZixDQUFELENBQXFCUyxJQUFyQixDQUEwQixvQkFBMUIsQ0FEUSxFQUVScEQsQ0FBQyxDQUFDMkMsQ0FBYyxDQUFDLENBQUQsQ0FBZixDQUFELENBQXFCUyxJQUFyQixDQUEwQixvQkFBMUIsQ0FUd0IsQ0FleEJELENBQUssR0FBS2xELENBQUksQ0FBQ08sV0FmUyxHQWdCeEJZLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHFCQUF1QjhCLENBQW5DLENBaEJ3QixDQWlCcEJFLENBakJvQixDQWtCcEJuRCxXQUFXLENBQUNjLFNBQVosQ0FBc0JtQyxDQUF0QixDQUE2QixDQUFDRyxRQUFRLEdBQVQsQ0FBN0IsQ0FsQm9CLENBb0JwQnBELFdBQVcsQ0FBQ2MsU0FBWixDQUFzQm1DLENBQXRCLENBcEJvQixDQXNCeEJsRCxDQUFJLENBQUNPLFdBQUwsQ0FBbUIyQyxDQXRCSyxDQXdCL0IsQ0F4QkQsS0F3QnFDLENBQTFCLEdBQUFSLENBQWMsQ0FBQ3pCLE1BQWYsRUFBd0QsQ0FBekIsRUFBQXlCLENBQWMsQ0FBQ3pCLE1BeEJ6RCxJQXlCS2pCLENBQUksQ0FBQ0MsV0FBTixDQUFtQnFELFFBQW5CLENBQTRCLGNBQTVCLENBekJKLENBMEJJdEQsQ0FBSSxDQUFDTSxjQUFMLEdBMUJKLENBNkJILENBdEhRLENBdUhUaUQsU0FBUyxDQUFFLG9CQUFXLENBQ3BCdkQsQ0FBSSxDQUFDRyxHQUFMLENBQVlILENBQUksQ0FBQ0MsV0FBTixDQUFtQjRDLE1BQW5CLEdBQTRCMUMsR0FEbkIsQ0FFcEJILENBQUksQ0FBQ0ksTUFBTCxDQUFlSixDQUFJLENBQUNDLFdBQU4sQ0FBbUJ1RCxJQUFuQixDQUF3QixPQUF4QixFQUFpQ3BELE1BQWpDLEVBRk0sQ0FHcEJKLENBQUksQ0FBQ0ssTUFBTCxDQUFjLENBQU9MLENBQUksQ0FBQ0csR0FBWixHQUEwQkgsQ0FBSSxDQUFDSSxNQUM5QyxDQTNIUSxDQUFiLENBOEhBO0FBS0E7QUFRQTtBQVpBSixDQUFJLENBQUNDLFdBQUwsQ0FBbUJGLENBQUMsQ0FBQyxjQUFELENBaklYLENBa0lUQyxDQUFJLENBQUNFLFFBQUwsQ0FBZ0JILENBQUMsQ0FBQyxxQkFBRCxDQWxJUixDQW1JVEMsQ0FBSSxDQUFDdUQsU0FBTCxFQW5JUyxDQXNJVHhELENBQUMsQ0FBRTBELE1BQUYsQ0FBRCxDQUFZQyxNQUFaLENBQW1CLFVBQVcsQ0FDMUI7QUFDQTtBQUNBO0FBQ0ExRCxDQUFJLENBQUN1RCxTQUFMLEVBQ0gsQ0FMRCxDQXRJUyxDQThJVHRELFdBQVcsQ0FBQzBELEVBQVosQ0FBZSxPQUFmLENBQXdCLFVBQXNCLENBQzFDLEdBQUlDLENBQUFBLENBQVksR0FBaEIsQ0FDQTdELENBQUMsQ0FBQzBELE1BQUQsQ0FBRCxDQUFVSSxNQUFWLENBQWlCLFVBQVcsQ0FDMUJELENBQVksR0FDYixDQUZELENBRjBDLENBSzFDRSxXQUFXLENBQUMsVUFBVyxDQUNqQkYsQ0FEaUIsR0FFbkI1RCxDQUFJLENBQUN5QyxNQUFMLEVBRm1CLENBR25CbUIsQ0FBWSxHQUhPLENBS3RCLENBTFUsQ0FLUixFQUxRLENBTCtCLENBWUwsQ0FBakMsRUFBQTdELENBQUMsQ0FBQyxtQkFBRCxDQUFELENBQXVCa0IsTUFaZSxFQWF4Q2pCLENBQUksQ0FBQ3lCLFlBQUwsRUFFTCxDQWZELENBOUlTLENBOEpUeEIsV0FBVyxDQUFDYyxTQUFaLENBQXNCLFFBQXRCLENBQ0gsQ0EvSkQsRUErSkdnRCxNQS9KSCxDIiwic291cmNlc0NvbnRlbnQiOlsiLyogdXNlIHN0cmljdCAqL1xuXG4oZnVuY3Rpb24oJCkge1xuXG4gICAgY29uc3QgcGxvdCA9IHtcbiAgICAgICAgc2NhdHRlcnBsb3Q6IG51bGwsXG4gICAgICAgIHdyYXBwZXJzOiBbXSxcbiAgICAgICAgdG9wOiBudWxsLFxuICAgICAgICBoZWlnaHQ6IG51bGwsXG4gICAgICAgIGJvdHRvbTogbnVsbCxcbiAgICAgICAgaXNUcmFuc2l0aW9uYWw6IGZhbHNlLFxuICAgICAgICBhY3RpdmVTdGF0ZTogJ3N0YXRlMScsXG4gICAgICAgIC8vIHNlYXJjaEl0ZW1JRHM6IFtdLFxuICAgICAgICBzZWFyY2hFbDogbnVsbCxcbiAgICAgICAgc2VhcmNoUHJvcHM6IHsgLy8gUHJvcHMgcGFzc2VkIGluIHRvIGluaXQgdGhlIHNlYXJjaCBpbnB1dChzKVxuICAgICAgICAgIGFsZ29saWFJZDogJ1FQSjEyV1NWUjQnLFxuICAgICAgICAgIGFsZ29saWFLZXk6ICdiYWU5ZTQ2MDRkYmQyNjNjYzQ3YzQ4YmZiMzBkZDVkYycsXG4gICAgICAgICAgb25TdWdnZXN0aW9uU2VsZWN0ZWQ6IGZ1bmN0aW9uKGhpdCkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2hpdCcpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coaGl0KTtcbiAgICAgICAgICAgIHNlYXJjaEl0ZW1JRHNbMF0gPSBoaXRbJ2lkJ107XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhzZWFyY2hJdGVtSURzKTtcbiAgICAgICAgICAgIHNjYXR0ZXJwbG90LmxvYWRTdGF0ZShwbG90LmFjdGl2ZVN0YXRlKTtcbiAgICAgICAgICAgIC8vIEdBIEV2ZW50IHN1Ym1pc3Npb25cbiAgICAgICAgICAgIGNvbnN0ICRoaWdobGlnaHRlZERpc3RyaWN0ID0gJyc7XG4gICAgICAgICAgICBpZiAoISFkYXRhTGF5ZXIgJiYgKGRhdGFMYXllci5sZW5ndGggPj0gMykpIHtcbiAgICAgICAgICAgICAgZGF0YUxheWVyLnB1c2goe1xuICAgICAgICAgICAgICAgICdldmVudCc6ICdkaXN0cmljdEhpZ2hsaWdodGVkJyxcbiAgICAgICAgICAgICAgICAnaGlnaGxpZ2h0ZWREaXN0cmljdCc6IGhpdFsnbmFtZSddXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2RhdGFMYXllciBub3QgYXZhaWxhYmxlLiBTa2lwcGluZyBhbmFseXRpY3MgcmVwb3J0aW5nIGZvciBoaWdobGlnaHRlZCBpdGVtIHNlbGVjdC4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uU2VsZWN0ZWRDbGVhcjogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZSk7XG4gICAgICAgICAgICAvLyBDbGVhciBzZWFyY2ggaXRlbSBhcnJheVxuICAgICAgICAgICAgc2VhcmNoSXRlbUlEcyA9IFtdO1xuICAgICAgICAgICAgLy8gUmVsb2FkIHN0YXRlXG4gICAgICAgICAgICBzY2F0dGVycGxvdC5sb2FkU3RhdGUocGxvdC5hY3RpdmVTdGF0ZSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBpbmRpY2VzOiBbJ2Rpc3RyaWN0cyddLFxuICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnSGlnaGxpZ2h0IGEgZGlzdHJpY3QuLi4nLFxuICAgICAgICAgICAgJ2FyaWEtbGFiZWwnOiAnRW50ZXIgYSBkaXN0cmljdCBuYW1lIHRvIHNlYXJjaCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlbmRlclNlYXJjaDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy8gJGVsZW1lbnRzID0gJCgnLnNlYXJjaC1jb21wb25lbnQnKTtcbiAgICAgICAgICAvLyAkZWxlbWVudHMuZWFjaChmdW5jdGlvbihlbCkge1xuICAgICAgICAgIC8vICAgKHBsb3Quc2VhcmNoRWwpLnB1c2gobmV3IHBsb3Quc2VhcmNoSW5pdChwbG90LnNlYXJjaFByb3BzLCBlbCkpO1xuICAgICAgICAgIC8vIH0pO1xuICAgICAgICAgIHZhciByb290RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoQ29tcG9uZW50Jyk7XG4gICAgICAgICAgcGxvdC5zZWFyY2hFbCA9IG5ldyBwbG90LnNlYXJjaEluaXQocGxvdC5zZWFyY2hQcm9wcywgcm9vdEVsKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2VhcmNoSW5pdDogZnVuY3Rpb24ocHJvcHMsIGNvbnRhaW5lcikge1xuICAgICAgICAgIHZhciBfc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAvLyBhZGQgcmVmZXJlbmNlIHRvIHRoZSBjb21wb25lbnQgdG8gcHJvcHNcbiAgICAgICAgICB2YXIgcmVmUHJvcHMgPSBPYmplY3QuYXNzaWduKHByb3BzLCB7XG4gICAgICAgICAgICByZWY6IGZ1bmN0aW9uKHJlZikgeyBfc2VsZi5jb21wb25lbnQgPSByZWY7IH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHRoaXMucmVuZGVyID0gZnVuY3Rpb24ocHJvcHMpIHtcbiAgICAgICAgICAgIFJlYWN0RE9NLnJlbmRlcihcbiAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChTZWRhU2VhcmNoLCBwcm9wcywgbnVsbCksXG4gICAgICAgICAgICAgIGNvbnRhaW5lclxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5yZW5kZXIocmVmUHJvcHMpO1xuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3VwZGF0ZScpO1xuICAgICAgICAgICAgdmFyIGFjdGl2ZVdyYXBwZXJzID0gJC5ncmVwKHBsb3Qud3JhcHBlcnMsIGZ1bmN0aW9uKGVsKSB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IHRvcCBhbmQgYm90dG9tIHkgY29vcmRzIG9mIHdyYXBwZXJcbiAgICAgICAgICAgICAgICBwbG90LnRvcCA9IChwbG90LnNjYXR0ZXJwbG90KS5vZmZzZXQoKS50b3AgKyAxMjA7IC8vICsgNDYyO1xuICAgICAgICAgICAgICAgIHZhciB3cmFwcGVyVG9wID0gJChlbCkub2Zmc2V0KCkudG9wOyAvLyAkKGVsKS5vZmZzZXQoKS50b3AgLSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XG4gICAgICAgICAgICAgICAgLy8gdmFyIHdyYXBwZXJIZWlnaHQgPSAkKGVsKS5oZWlnaHQoKTtcbiAgICAgICAgICAgICAgICB2YXIgd3JhcHBlckhlaWdodCA9ICQoZWwpLm91dGVySGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgdmFyIHdyYXBwZXJCb3R0b20gPSBOdW1iZXIod3JhcHBlclRvcCkgKyBOdW1iZXIod3JhcHBlckhlaWdodCk7XG4gICAgICAgICAgICAgICAgLy8gSWYgcGxvdCB0b3Agb3IgYm90dG9tIGFyZSB3aXRoaW5cbiAgICAgICAgICAgICAgICAvLyBhZGQgdG8gYWN0aXZlV3JhcHBlcnMuXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3Bsb3QudG9wID0gJyArIHBsb3QudG9wKTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnb2Zmc2V0KCkudG9wID0gJyArICQoZWwpLm9mZnNldCgpLnRvcCk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3Njcm9sbHRvcCA9ICcgKyAkKHdpbmRvdykuc2Nyb2xsVG9wKCkpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd3cmFwcGVyVG9wID0gJyArIHdyYXBwZXJUb3ApO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd3cmFwcGVyQm90dG9tID0gJyArIHdyYXBwZXJCb3R0b20pO1xuICAgICAgICAgICAgICAgIGlmICgocGxvdC50b3AgPj0gd3JhcHBlclRvcCAmJiBwbG90LnRvcCA8PSB3cmFwcGVyQm90dG9tKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnSXRcXCdzIHdpdGhpbiBhIHdyYXBwZXIuJyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkKGVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGFjdGl2ZVdyYXBwZXJzKTtcbiAgICAgICAgICAgIGlmIChhY3RpdmVXcmFwcGVycy5sZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdPbmUgaXRlbSBpbiBhY3RpdmVXcmFwcGVycy4nKTtcbiAgICAgICAgICAgICAgICAocGxvdC5zY2F0dGVycGxvdCkucmVtb3ZlQ2xhc3MoJ3RyYW5zaXRpb25hbCcpO1xuICAgICAgICAgICAgICAgIHBsb3QuaXNUcmFuc2l0aW9uYWwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvLyBTZXQgc3RhdGUgdG8gdGhlIGZpcnN0IG9uZS5cbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhhY3RpdmVXcmFwcGVyc1swXSk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gJChhY3RpdmVXcmFwcGVyc1swXSkuYXR0cignZGF0YS1wbG90LXN0YXRlJyk7XG4gICAgICAgICAgICAgICAgdmFyIG5vdG1lcmdlID1cbiAgICAgICAgICAgICAgICAgICAgJChhY3RpdmVXcmFwcGVyc1swXSkuYXR0cignZGF0YS1wbG90LW5vdG1lcmdlJykgP1xuICAgICAgICAgICAgICAgICAgICAkKGFjdGl2ZVdyYXBwZXJzWzBdKS5hdHRyKCdkYXRhLXBsb3Qtbm90bWVyZ2UnKSA6XG4gICAgICAgICAgICAgICAgICAgIGZhbHNlO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgICAgIC8vICAgICAnU3RhdGUgPSAnICsgc3RhdGUgK1xuICAgICAgICAgICAgICAgIC8vICAgICAnLiBBY3RpdmUgc3RhdGUgPSAnICsgcGxvdC5hY3RpdmVTdGF0ZSArXG4gICAgICAgICAgICAgICAgLy8gICAgICcuIE5vdE1lcmdlID0gJyArIFN0cmluZyhub3RtZXJnZSkgKyAnLicgKTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUgIT09IHBsb3QuYWN0aXZlU3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2xvYWRpbmcgbmV3IHN0YXRlICcgKyBzdGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub3RtZXJnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NhdHRlcnBsb3QubG9hZFN0YXRlKHN0YXRlLCB7bm90TWVyZ2U6IHRydWV9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjYXR0ZXJwbG90LmxvYWRTdGF0ZShzdGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcGxvdC5hY3RpdmVTdGF0ZSA9IHN0YXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aXZlV3JhcHBlcnMubGVuZ3RoID09PSAwIHx8IGFjdGl2ZVdyYXBwZXJzLmxlbmd0aCA+PSAxKSB7XG4gICAgICAgICAgICAgICAgKHBsb3Quc2NhdHRlcnBsb3QpLmFkZENsYXNzKCd0cmFuc2l0aW9uYWwnKTtcbiAgICAgICAgICAgICAgICBwbG90LmlzVHJhbnNpdGlvbmFsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnSW4gdHJhbnNpdGlvbi4gU3RhdGUgPSAnICsgc3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBnZXRDb29yZHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHBsb3QudG9wID0gKHBsb3Quc2NhdHRlcnBsb3QpLm9mZnNldCgpLnRvcDtcbiAgICAgICAgICBwbG90LmhlaWdodCA9IChwbG90LnNjYXR0ZXJwbG90KS5maW5kKCc+IGRpdicpLmhlaWdodCgpO1xuICAgICAgICAgIHBsb3QuYm90dG9tID0gTnVtYmVyKHBsb3QudG9wKSArIE51bWJlcihwbG90LmhlaWdodCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gR2V0IHRvcCBhbmQgYm90dG9tIHkgY29vcmRzIG9mIHRoZSBzY2F0dGVycGxvdFxuICAgIHBsb3Quc2NhdHRlcnBsb3QgPSAkKCcjc2NhdHRlcnBsb3QnKTtcbiAgICBwbG90LndyYXBwZXJzID0gJCgnLnN0YXRlLWRlc2Mtd3JhcHBlcicpO1xuICAgIHBsb3QuZ2V0Q29vcmRzKCk7XG5cbiAgICAvLyBSZXNldCB0aGVtIGlmIHRoZSBzY3JlZW4gaXMgcmVzaXplZFxuICAgICQoIHdpbmRvdyApLnJlc2l6ZShmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gcGxvdC50b3AgPSAocGxvdC5zY2F0dGVycGxvdCkub2Zmc2V0KCkudG9wO1xuICAgICAgICAvLyBwbG90LmhlaWdodCA9IChwbG90LnNjYXR0ZXJwbG90KS5maW5kKCc+IGRpdicpLmhlaWdodCgpO1xuICAgICAgICAvLyBwbG90LmJvdHRvbSA9IE51bWJlcihwbG90LnRvcCkgKyBOdW1iZXIocGxvdC5oZWlnaHQpO1xuICAgICAgICBwbG90LmdldENvb3JkcygpO1xuICAgIH0pO1xuXG4gICAgLy8gT25seSB0cmlnZ2VyIHNjcm9sbCBldmVyIDUwbXMgc28gbGVzcyByZXNvdXJjZXNcbiAgICBzY2F0dGVycGxvdC5vbigncmVhZHknLCBmdW5jdGlvbihzY2F0dGVycGxvdCkge1xuICAgICAgICB2YXIgdXNlclNjcm9sbGVkID0gZmFsc2U7XG4gICAgICAgICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdXNlclNjcm9sbGVkID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmICh1c2VyU2Nyb2xsZWQpIHtcbiAgICAgICAgICAgIHBsb3QudXBkYXRlKCk7IC8vIEBsYW5lLCBkaXNhYmxlZCBkZWZhdWx0IHNjcm9sbCBldmVudCBpbml0IGhlcmUuXG4gICAgICAgICAgICB1c2VyU2Nyb2xsZWQgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIDUwKTtcblxuICAgICAgICBpZiAoJCgnLnNlYXJjaC1jb21wb25lbnQnKS5sZW5ndGggPj0gMSkge1xuICAgICAgICAgIHBsb3QucmVuZGVyU2VhcmNoKCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBzY2F0dGVycGxvdC5sb2FkU3RhdGUoJ3N0YXRlMScpO1xufSkoalF1ZXJ5KTtcbiJdfQ==